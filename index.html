<!DOCTYPE html>
<html>

  <head>
    
  </head>

  <body>
    <button id="auth-button"><a href="https://oauth.vk.com/authorize?client_id=6223974&display=page&redirect_uri=https://e-chernov.github.io&scope=friends&response_type=token&v=5.52">Авторизоваться</a></button>
    <div id="info"></div>
    <script>
      
      const hash = window.location.hash;
      let response, token, id;

      if (hash) {
        token = hash.slice(hash.indexOf('=') + 1, hash.indexOf('&'));
        id = hash.slice(hash.indexOf('id') + 3);
        console.log('Token ' + token);
        console.log('ID ' + id);
      }
      
      let script = document.createElement('SCRIPT');
        script.src = 'https://api.vk.com/method/users.get?user_ids=' + id + '&fields=bdate&v=5.68&callback=callbackFunc';
        document.getElementsByTagName('head')[0].appendChild(script);
        function callbackFunc(result) {
            alert(result.response[0].first_name)
        }
      
      /*let xhr = new XMLHttpRequest();
      xhr.open('GET', 'https://api.vk.com/method/account.getProfileInfo&access_token=' + token + '&v=V ', true);
      xhr.send();
      xhr.onreadystatechange = function() {
        if (this.readyState != 4) return;
        if (this.status != 200) {
          alert( 'ошибка: ' + (this.status ? this.statusText : 'запрос не удался') );
          return;
        }
        response = xhr.responseText;
      }*/
      
      /*const info = document.getElementById('info');
      let profileInfo = JSON.parse(response);
      
      info.innerHTML += 'Пользователь: ' + profileInfo.response.first_name + ' ' + profileInfo.response.last_name;
      
      const authButton = document.getElementById('auth-button');*/
      
      authButton.onclick = function() {
        window.location = 'https://oauth.vk.com/authorize?client_id=6223974&display=page&redirect_uri=https://e-chernov.github.io&scope=friends&response_type=token&v=5.52';
      }
      /*//https://oauth.vk.com/authorize?client_id=6223974&display=page&redirect_uri=https://e-chernov.github.io&scope=friends&response_type=token&v=5.52

      //https://oauth.vk.com/blank.html#access_token=6170a4a52ca7bebb146159035b1e40af16ebebbef175b082e4b8e9917042b1595a8bbcd98d673d0e846b6&expires_in=86400&user_id=56616468
    */
    </script>
  </body>

</html>
